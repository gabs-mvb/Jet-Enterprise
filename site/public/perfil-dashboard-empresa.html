<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perfil - Empresa</title>
  <link rel="stylesheet" href="css/perfil-sidebar.css" />
  <link rel="stylesheet" href="css/perfil-empresa.css" />
  <script src="./js/adminORusuario.js"></script>
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/sweetalert2@10.10.1/dist/sweetalert2.min.css'>
</head>

<body onload="buscarDadoFuncionario()">
  <main>
    <!-- Cor do fundo da pag -->
    <div class="background-color">
      <!-- SideBar do Perfil-->
      <div class="sidebar">
        <img src="uploads/user.svg" id="iconePerfil" class="icone-perfil" />
        <h3><span id="b_usuario">Nome Completo</span></h3>
        <nav>
          <ul class="sidebar-lista">
            <li>
              <a href="perfil-dashboard-empresa.html">
                <img src="assets/svg/empresa.svg" class="sidebar-icone-lista" width="50" height="54" viewBox="0 0 47 51" alt="">
    
                <span href="perfil-dashboard-empresa.html" class="sidebar-titulo">Empresa</span>
              </a>
            </li>
            <div class="sidebar-separacao"></div>
            <li>
              <a href="perfil-produtos-frios-congelados.html">
                <img src="assets/svg/produtos.svg" class="sidebar-icone-lista" width="50" height="54" viewBox="0 0 47 51" alt="">
                <span class="sidebar-titulo">Produtos</span>
              </a>
            </li>
            <div class="sidebar-separacao"></div>
            <li>
              <a href="perfil-dashboard-geral.html">
                <img src="assets/svg/dashboard.svg" class="sidebar-icone-lista" width="50" height="54" viewBox="0 0 47 51" alt="">
                <span class="sidebar-titulo">Dashboard</span>
              </a>
            </li>
            <div class="sidebar-separacao"></div>
            <li>
              <a href="perfil-notificacoes.html">
                <img src="assets/svg/notificacoes.svg" class="sidebar-icone-lista" width="50" height="54" viewBox="0 0 47 51" alt="">
                <span class="sidebar-titulo">Notificações</span>
              </a>
            </li>
            <div class="sidebar-separacao"></div>
            <li>
              <a href="perfil-config.html">
                <img src="assets/svg/configuracoes.svg" class="sidebar-icone-lista" width="50" height="54" viewBox="0 0 47 51" alt="">
                <span class="sidebar-titulo">Configurações</span>
              </a>
            </li>
            <li>
              <a href="https://suportejet.auvo.com.br/Ticket/Novo" target="_blank">
                <img src="assets/svg/suporte.svg" class="sidebar-icone-lista" width="50" height="54" viewBox="0 0 47 51" alt="">
                <span class="sidebar-titulo">Suporte</span>
              </a>
            </li>
            <div class="sidebar-separacao"></div>
            <li>
              <a href="index.html">
                <img src="assets/svg/logo.svg" class="sidebar-icone-lista" width="50" height="54" viewBox="0 0 47 51" alt="">
    
                <span class="sidebar-titulo">JET - Tela Inicial</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>

    <!--TITULO DA PAGINA-->
    <div class="configuracoes-titulo">
      <h1>EMPRESAS</h1>
    </div>
    <!--CONTAINER QUE ENGLOBA O CONTEUDO-->
    <div id="container-global" class="container-all">
      <!-- <div id="titulo_2_empresa" class="titulo-2">
        <h3 id="titulo_div_empresa">Cadastre sua empresa</h3>
        <p id="subtitulo_div_empresa">
          Por favor, insira os dados da empresa que você deseja cadastrar
        </p>
      </div>
      <div class="container-pai">
        <div id="container_filho_empresa" class="container-filho">
          <div id="nome_empresa_box" class="estilo-box">
            <p id="nome_empresa_cadastro">Nome da Empresa*</p>
            <input class="input-empresa" id="inputEmpresa" placeholder="Ex: Nubank" onblur="validarEmpresa()"
              required />
          </div>
          <div id="cnpj_empresa_box" class="estilo-box">
            <p id="cnpj_empresa_cadastro">CNPJ*</p>
            <input class="input-empresa" id="inputCNPJ" placeholder="Ex: 69443724000106" onblur="validarCNPJ()"
              required />
          </div>
          <div id="logradouro_empresa_box" class="estilo-box">
            <p id="logradouro_empresa_cadastro">Logradouro*</p>
            <input class="input-empresa" id="inputLogradouro" placeholder="Ex: Rua Lago Verde"
              onblur="validarLogradouro()" required />
          </div>
          <div class="estilo-box-2">
            <div id="cidade_empresa_box" class="cidade">
              <p id="cidade_empresa_cadastro">Cidade*</p>
              <br />
              <input class="input-empresa" id="inputCidade" placeholder="Ex: Boa Vista" onblur="validarCidade()" />
            </div>
            <div id="estado_empresa_box" class="estado">
              <p id="estado_empresa_cadastro">UF*</p>
              <br />
              <select class="select-estado" id="inputUF" name="estado" onclick="validarUF()">
                <option value="none"></option>
                <option value="AC">Acre</option>
                <option value="AL">Alagoas</option>
                <option value="AP">Amapá</option>
                <option value="AM">Amazonas</option>
                <option value="BA">Bahia</option>
                <option value="CE">Ceará</option>
                <option value="DF">Distrito Federal</option>
                <option value="ES">Espírito Santo</option>
                <option value="GO">Goiás</option>
                <option value="MA">Maranhão</option>
                <option value="MT">Mato Grosso</option>
                <option value="MS">Mato Grosso do Sul</option>
                <option value="MG">Minas Gerais</option>
                <option value="PA">Pará</option>
                <option value="PB">Paraíba</option>
                <option value="PR">Paraná</option>
                <option value="PE">Pernambuco</option>
                <option value="PI">Piauí</option>
                <option value="RJ">Rio de Janeiro</option>
                <option value="RN">Rio Grande do Norte</option>
                <option value="RS">Rio Grande do Sul</option>
                <option value="RO">Rondônia</option>
                <option value="RR">Roraima</option>
                <option value="SC">Santa Catarina</option>
                <option value="SP">São Paulo</option>
                <option value="SE">Sergipe</option>
                <option value="TO">Tocantins</option>
                <option value="EX">Estrangeiro</option>
              </select>
            </div>
          </div>
        </div>
        <div class="container-filho-2">
          <div id="cep_empresa_box" class="estilo-box">
            <p id="cep_empresa_cadastro">CEP*</p>
            <input class="input-empresa" id="inputCEP" placeholder="Ex: 69313175" onblur="validarCEP()" required />
          </div>

          <div id="bairro_empresa_box" class="estilo-box">
            <p id="bairro_empresa_cadastro">Bairro</p>
            <input class="input-empresa" id="inputBairro" placeholder="Ex: Jóquei Clube" onblur="validarBairro()" />
          </div>

          <div id="complemento_empresa_box" class="estilo-box">
            <p id="complemento_empresa_cadastro">Complemento</p>
            <input class="input-empresa active" id="inputComplemento" placeholder="Empresa 1"
              onblur="validarComplemento()" />
          </div>
        </div>
      </div>

      <button id="btn_cadastrar_empresa" class="botao-registro" onclick="botao_registro()">
        CADASTRAR
      </button> -->

      <!-- REGISTRO DO FUNCIONÁRIO -->
      <!-- <hr />

        <div class="titulo-2 funcionarios">
          <h3>Cadastre seus funcionários</h3>
          <p>Por favor, insira os dados do usuario que você deseja cadastrar</p>
        </div>

        <div class="container-pai">

          <div class="container-filho">
            <div class="estilo-box">
              <p>Username*</p>
              <input
                class="input-empresa"
                id="inputUsuario"
                onblur="validarUsuario()"
                placeholder="Ex: caique2022"
                required
              />
            </div>
            <div class="estilo-box">
              <p>Senha*</p>
              <input
                class="input-empresa"
                id="inputSenha"
                placeholder="Ex: Senha@123"
                type="password"
                onblur="validarSenha()"
                required
              />
            </div>
            <div class="estilo-box">
              <p>Nome Completo*</p>
              <input
                class="input-empresa"
                id="inputNome"
                placeholder="Ex: Caique Gomes da Silva"
                required
                onblur="validarNome()"
              />
            </div>
          </div>




          <div class="container-filho-2">
            <div class="estilo-box">
              <p>E-mail*</p>
              <input
                class="input-empresa"
                id="inputEmail"
                placeholder="Ex: caique.gsilva@sptech.school"
                required
                onblur="validarEmail()"
              />
            </div>

            <div class="estilo-box">
              <p>Telefone</p>
              <input
                class="input-empresa"
                type="number"
                placeholder="Ex: 11966193319"
                id="inputContato"
                onkeyup="validarContato()"
              />
            </div>


          </div>
        </div>

        <button
          class="botao-registro"
          onclick="cadastrarFuncionario()"
        >
          CADASTRAR
        </button>

        <hr />

        <div id="tabela_funcionarios" class="tabela-funcionarios">
          <h3>FUNCIONÁRIOS</h3>
        </div> -->

    </div>
  </main>
</body>

</html>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.10.1/dist/sweetalert2.all.min.js"></script>
<script src="js/perfil-validacao.js"></script>

<script>
  b_usuario.innerHTML = sessionStorage.NOME_USUARIO;
  iconePerfil.src = sessionStorage.PERFIL_IMAGEM;

  function buscarDadoFuncionario() {
    var idEmpresa = sessionStorage.ID_EMPRESA;
    fetch(`/funcionario/listarFuncionario/${idEmpresa}`)
      .then(function (resposta) {
        console.log('estou na Buscarfuncionario()', resposta);
        if (resposta.ok) {
          if (resposta.status == 204) {
            var tabelaFuncionarios = document.getElementById("tabela_funcionarios");
            var mensagem = document.createElement("span");
            mensagem.classList.add('mensagem');
            mensagem.innerHTML = "Nenhum resultado encontrado.";
            tabelaFuncionarios.appendChild(mensagem);
            throw "Nenhum resultado encontrado!!";
          }

          resposta.json().then(function (resposta) {
            console.log("Dados recebidos: ", JSON.stringify(resposta));

            var tabelaFuncionarios = document.getElementById("tabela_funcionarios");
            tabelaFuncionarios.innerHTML = "<h3>FUNCIONÁRIOS</h3>";
            for (let i = 0; i < resposta.length; i++) {
              var publicacao = resposta[i];

              // criando e manipulando elementos do HTML via JavaScript

              var tamanhoSenha = atob(publicacao.senha)
              var visualSenha = ""

              for(var a = 0; a < tamanhoSenha.length ; a++) {
                visualSenha += '*'
              }

              tabelaFuncionarios.innerHTML += `
                        
              <div class="func" id="${i}">
                      <div class="estilo-atributos">
                        <h5>Login:</h5>
                        <p>${publicacao.username}</p>
                      </div>
                      <div class="estilo-atributos">
                        <h5>Senha:</h5>
                        <p>${visualSenha}</p>
                      </div>
                      <div class="estilo-atributos">
                        <h5>Nome Completo:</h5>
                        <p>${publicacao.nome}</p>
                      </div>
                      <div class="estilo-atributos">
                        <h5>Email:</h5>
                        <p>${publicacao.email}</p>
                      </div>
                      <div class="estilo-atributos">
                        <h5>Telefone:</h5>
                        <p>${publicacao.telefone}</p>
                      </div>
                      <div class="estilo-atributos">
                        <h5>Função:</h5>
                        <p>${publicacao.funcao}</p>
                      </div>
                      <button class="removerCard" onclick="removerCard(${publicacao.idPerfil})">Remover</button>
                  </div>
                    `;
            }
          });
        } else {
          throw console.log('Estou na buscarDadosFuncionario()', JSON.stringify(resposta));
        }
      })
      .catch(function (resposta) {
        console.log(resposta);
      });
  }




  function cadastrarEmpresa() {
    //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo
    var empresaNomeVar = inputEmpresa.value;
    var cnpjVar = inputCNPJ.value;
    var logradouroVar = inputLogradouro.value;
    var cidadeVar = inputCidade.value;
    var estadoVar = inputUF.value;
    var cepVar = inputCEP.value;
    var bairroVar = inputBairro.value;
    var complementoVar = inputComplemento.value;

    // Enviando o valor da nova input
    fetch("/empresa/cadastrarEmpresa", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        empresaNomeServer: empresaNomeVar,
        cnpjServer: cnpjVar,
        logradouroServer: logradouroVar,
        cidadeServer: cidadeVar,
        estadoServer: estadoVar,
        cepServer: cepVar,
        bairroServer: bairroVar,
        complementoVar: complementoVar,
      }),
    })
      .then(function (resposta) {
        console.log("resposta: ", resposta);
        // Se sucesso, ele atualiza o id da empresa dentro da sessionStorage e atualiza a pág
        if (resposta.ok) {
          Swal.fire({
          icon: 'success',
          title: 'Parabéns',
          text: 'Cadastro realizado com sucesso!',
          })

          setTimeout(() => selectEmpresa(), 3000);

        } else {
          throw "Houve um erro ao tentar realizar o cadastro!";
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        // finalizarAguardar();
      });

    return false;
  }


  function selectEmpresa() {
    fetch("/empresa/selectEmpresa").then(function (resposta) {
      if (resposta.ok) {
        if (resposta.status == 204) {
          Swal.fire({
          icon: 'error',
          title: 'Ops...',
          text: 'Nenhum produto encontrado!',
          })
        }
        resposta.json().then(function (resposta) {
          console.log("Dados recebidos: ", JSON.stringify(resposta));

          sessionStorage.ID_EMPRESA = resposta[0].idEmpresa;
          updateEmpresa();
        });
      } else {
        throw ('Houve um erro na API!');
      }
    }).catch(function (resposta) {
      console.error(resposta);
    });
  }

  function updateEmpresa() {

    var idPerfil = sessionStorage.ID_PERFIL;
    var idEmpresa = sessionStorage.ID_EMPRESA;

    fetch("/usuarios/updateEmpresa/", {
      method: "PUT",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        idPerfil,
        idEmpresa
      })
    }).then(function (resposta) {
      buscarDadosEmpresa();
      if (resposta.status == 404) {
        Swal.fire({
          icon: 'error',
          title: 'Ops...',
          text: 'Deu 404!',
          })
      } else {
        throw ("Houve um erro ao tentar realizar a postagem! Código da resposta: " + resposta.status);
      }
    }).catch(function (resposta) {
      console.log(`#ERRO: ${resposta}`);
    })
    window.location = "./perfil-dashboard-empresa.html"
  }


  function buscarDadosEmpresa() {
    var idEmpresa = sessionStorage.ID_EMPRESA;
    if (sessionStorage.ID_EMPRESA) {
      fetch(`/empresa/buscarDadosEmpresa/${idEmpresa}`, {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then(function (resposta) {
          if (resposta.ok) {
            // resposta.json().then((json) => {

            resposta.json().then(function (resposta) {
              console.log("Dados recebidos: ", JSON.stringify(resposta));

              var divSuprema = document.getElementById('container-global');
              var divTituloEmpresa = document.createElement('div');
              var h3Empresa = document.createElement('h3');
              divTituloEmpresa.id = "titulo_2_empresa";
              divTituloEmpresa.className = "titulo-2";
              h3Empresa.innerHTML = resposta[0].nomeEmpresa;
              divTituloEmpresa.appendChild(h3Empresa);
              divSuprema.appendChild(divTituloEmpresa);


              var containerPai = document.createElement("div");
              containerPai.className = "container-pai"
              var containerFilhoEmpresa = document.createElement("div");
              containerFilhoEmpresa.id = "container_filho_empresa";
              containerFilhoEmpresa.className = "container-filho";
              containerPai.appendChild(containerFilhoEmpresa);
              divSuprema.appendChild(containerPai);

              //  Nome da Empresa

               var divNomeEmpresa = document.createElement("div");
               divNomeEmpresa.id = "nome_empresa_box";
               divNomeEmpresa.className = "estilo-box";
               containerFilhoEmpresa.appendChild(divNomeEmpresa);
              var PnomeEmpresaCadastro = document.createElement("p");
              PnomeEmpresaCadastro.innerHTML = "Nome da Empresa";
              divNomeEmpresa.appendChild(PnomeEmpresaCadastro);
              divNomeEmpresa.innerHTML += resposta[0].nomeEmpresa;


              //cnpj da empresa

              var divCNPJEmpresa = document.createElement("div");
              divCNPJEmpresa.id = "cnpj_empresa_box";
              divCNPJEmpresa.className = "estilo-box";
              containerFilhoEmpresa.appendChild(divCNPJEmpresa);
              var PcnpjEmpresa = document.createElement("p");
              PcnpjEmpresa.innerHTML = "CNPJ";
              divCNPJEmpresa.appendChild(PcnpjEmpresa);
              divCNPJEmpresa.innerHTML += resposta[0].cnpj;


              //Logradouro da empresa


              var divLogradouro = document.createElement("div");
              divLogradouro.id = "logradouro_empresa_box";
              divLogradouro.className = "estilo-box";
              containerFilhoEmpresa.appendChild(divLogradouro);
              var Plogradouro = document.createElement("p");
              Plogradouro.innerHTML = "Logradouro";
              divLogradouro.appendChild(Plogradouro);
              divLogradouro.innerHTML += resposta[0].logradouro;


              //Cidade da empresa

              var divCidadeandUF = document.createElement("div");
              divCidadeandUF.className = "estilo-box-2";
              var divCidade = document.createElement("div");
              divCidadeandUF.appendChild(divCidade);
              containerFilhoEmpresa.appendChild(divCidadeandUF);
              divCidade.id = "cidade_empresa_box";
              divCidade.className = "cidade";
              var Pcidade = document.createElement("p");
              Pcidade.id = "cidade_empresa_cadastro";
              Pcidade.innerHTML = "Cidade";
              divCidade.appendChild(Pcidade);
              divCidade.innerHTML += resposta[0].cidade;



              //Estado da empresa

              var divEstado = document.createElement("div");
              divCidadeandUF.appendChild(divEstado);
              divEstado.id = "estado_empresa_box";
              divEstado.className = "estado";
              var Pestado = document.createElement("p");
              Pestado.id = "estado_empresa_cadastro";
              Pestado.innerHTML = "UF";
              divEstado.appendChild(Pestado);
              divEstado.innerHTML += resposta[0].estado
              


              //Cep da empresa

              var containerFilhoEmpresa2 = document.createElement("div");

              containerPai.appendChild(containerFilhoEmpresa2);
              containerFilhoEmpresa2.className = "container-filho-2";

              var divCep = document.createElement("div");
              divCep.id = "cep_empresa_box";
              divCep.className = "estilo-box";
              var Pcep = document.createElement("p");
              Pcep.id = "cep_empresa_cadastro";
              Pcep.innerHTML = "CEP";
              divCep.appendChild(Pcep);
              divCep.innerHTML += resposta[0].cep;
              containerFilhoEmpresa2.appendChild(divCep);


              //Bairro da empresa


              var divBairro = document.createElement("div");
              divBairro.id = "cnpj_empresa_box";
              divBairro.className = "estilo-box";
              var Pbairro = document.createElement("p");
              Pbairro.id = "bairro_empresa_cadastro";
              Pbairro.innerHTML = "Bairro";
              divBairro.appendChild(Pbairro);
              divBairro.innerHTML += resposta[0].bairro;
              containerFilhoEmpresa2.appendChild(divBairro);


              //Complemento da empresa

              var nomeComplemento = ""

              if(resposta[0].complemento == null) {
                nomeComplemento = ""
              } else {
                nomeComplemento = resposta[0].complemento
                var divComplemento = document.createElement("div");
              divComplemento.id = "complemento_empresa_box";
              divComplemento.className = "estilo-box";
              var Pcomplemento = document.createElement("p");
              Pcomplemento.id = "complemento_empresa_cadastro";
              Pcomplemento.innerHTML = "Complemento";
              divComplemento.appendChild(Pcomplemento);
              divComplemento.innerHTML += nomeComplemento;
              containerFilhoEmpresa2.appendChild(divComplemento);
              }



              document.getElementById(
                "container_filho_empresa"
              ).style.marginLeft = "17vw";
              document.getElementById("titulo_2_empresa").style.marginLeft =
                "12vw";

                var containerGlobal = document.getElementById("container-global");

    var divisoria = document.createElement("hr");
    var divTituloFunc = document.createElement("div");
    var titulo = document.createElement("h3");
    var subtitulo = document.createElement("p");

    divTituloFunc.className = "titulo-2 funcionarios";
    titulo.innerHTML = "Cadastre seus funcionários";
    subtitulo.innerHTML =
      "Por favor, insira os dados do usuario que você deseja cadastrar";

    containerGlobal.appendChild(divisoria);
    containerGlobal.appendChild(divTituloFunc);
    divTituloFunc.appendChild(titulo);
    divTituloFunc.appendChild(subtitulo);

    // -------------------------------------------------------

    // -------------- CONTAINER CADASTRO FUNC ----------------

    var containerPai = document.createElement("div");
    var containerFilho = document.createElement("div");
    var containerFilho2 = document.createElement("div");
    containerPai.className = "container-pai";
    containerFilho.className = "container-filho";
    containerFilho2.className = "container-filho-2"

    containerGlobal.appendChild(containerPai);
    containerPai.appendChild(containerFilho);
    containerPai.appendChild(containerFilho2);

    for (var i = 0; i < 3; i++) {

      var divContainer = document.createElement("div");
      var tituloContainer = document.createElement("p");
      var inputContainer = document.createElement("input");

      divContainer.className = "estilo-box";
      inputContainer.className = "input-empresa"

      if (i == 0) {
        tituloContainer.innerHTML = `Username*`;
        inputContainer.id = "inputUsuario";
        inputContainer.placeholder = "Ex: caique2022";
        inputContainer.setAttribute("onblur", "validarUsuario()");
        inputContainer.setAttribute("required", "required");
      } else if(i == 1) {
        tituloContainer.innerHTML = "Senha*";
        inputContainer.id = "inputSenha";
        inputContainer.placeholder = "Ex: Senha@123";
        inputContainer.setAttribute("onblur", "validarSenha()");
        inputContainer.type = "password";
        inputContainer.setAttribute("required", "required");
      } else if(i == 2) {
        tituloContainer.innerHTML = "Nome Completo*";
        inputContainer.id = "inputNome";
        inputContainer.placeholder = "Ex: Caique Gomes da Silva";
        inputContainer.setAttribute("onblur", "validarNome()");
        inputContainer.setAttribute("required", "required");
      }

      containerFilho.appendChild(divContainer);
      divContainer.appendChild(tituloContainer);
      divContainer.appendChild(inputContainer);
    }

    for(var a = 0; a < 3; a++) {
        var divContainer2 = document.createElement("div");
        var tituloContainer2 = document.createElement("p");
        var inputContainer2 = document.createElement("input");

        divContainer2.className = "estilo-box";
      inputContainer2.className = "input-empresa";

      if (a == 0) {
        tituloContainer2.innerHTML = `E-mail*`;
        inputContainer2.id = "inputEmail";
        inputContainer2.placeholder = "Ex: caique.gsilva@sptech.school";
        inputContainer2.setAttribute("onblur", "validarEmail()");
        inputContainer2.setAttribute("required", "required");
        divContainer2.appendChild(tituloContainer2);
        divContainer2.appendChild(inputContainer2);
      } else if(a == 1) {
        tituloContainer2.innerHTML = "Telefone";
        inputContainer2.id = "inputContato";
        inputContainer2.placeholder = "Ex: 11966193319";
        inputContainer2.setAttribute("onkeyup", "validarContato()");
        inputContainer2.type = "number";
        divContainer2.appendChild(tituloContainer2);
        divContainer2.appendChild(inputContainer2);
      } else if(a == 2) {
        divContainer2.innerHTML += `<p>Função</p>
        <select class="combo-funcao" id="inputFuncao">
          <option value="Administrador">Administrador</option>
          <option value="Usuário">Usuário</option>
        </select>`
      }
    
      containerFilho2.appendChild(divContainer2);
      
      
    }

    var buttonCadastro = document.createElement('button');
    var divisoria2 = document.createElement("hr");
    buttonCadastro.className = "botao-registro";
    buttonCadastro.setAttribute("Onclick", "botao_registro_func()");
    buttonCadastro.innerHTML = "CADASTRO";
    containerGlobal.appendChild(buttonCadastro);
    containerGlobal.appendChild(divisoria2)

    var divTabelaFuncionario = document.createElement("div");
    var tituloTabelaFunc = document.createElement("h3");
    divTabelaFuncionario.className ="tabela-funcionarios"
    divTabelaFuncionario.id = "tabela_funcionarios"
    tituloTabelaFunc.innerHTML = "FUNCIONÁRIOS";

    divTabelaFuncionario.appendChild(tituloTabelaFunc);
    containerGlobal.appendChild(divTabelaFuncionario);
  

            });

          }
        })
        .catch(function (resposta) {
          console.log(`#ERRO: ${resposta}`);
        });
    }
  }

  function buscardadosEmpresa2() {
    var idEmpresa = sessionStorage.ID_EMPRESA;
    if (sessionStorage.ID_EMPRESA) {
      fetch(`/empresa/buscarDadosEmpresa/${idEmpresa}`, {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then(function (resposta) {
          if (resposta.ok) {
            // resposta.json().then((json) => {

            resposta.json().then(function (resposta) {
              console.log("Dados recebidos: ", JSON.stringify(resposta));

              var divSuprema = document.getElementById('container-global');
              var divTituloEmpresa = document.createElement('div');
              var h3Empresa = document.createElement('h3');
              divTituloEmpresa.id = "titulo_2_empresa";
              divTituloEmpresa.className = "titulo-2";
              h3Empresa.innerHTML = resposta[0].nomeEmpresa;
              divTituloEmpresa.appendChild(h3Empresa);
              divSuprema.appendChild(divTituloEmpresa);


              var containerPai = document.createElement("div");
              containerPai.className = "container-pai"
              var containerFilhoEmpresa = document.createElement("div");
              containerFilhoEmpresa.id = "container_filho_empresa";
              containerFilhoEmpresa.className = "container-filho";
              containerPai.appendChild(containerFilhoEmpresa);
              divSuprema.appendChild(containerPai);

              //  Nome da Empresa

               var divNomeEmpresa = document.createElement("div");
               divNomeEmpresa.id = "nome_empresa_box";
               divNomeEmpresa.className = "estilo-box";
               containerFilhoEmpresa.appendChild(divNomeEmpresa);
              var PnomeEmpresaCadastro = document.createElement("p");
              PnomeEmpresaCadastro.innerHTML = "Nome da Empresa";
              divNomeEmpresa.appendChild(PnomeEmpresaCadastro);
              divNomeEmpresa.innerHTML += resposta[0].nomeEmpresa;


              //cnpj da empresa

              var divCNPJEmpresa = document.createElement("div");
              divCNPJEmpresa.id = "cnpj_empresa_box";
              divCNPJEmpresa.className = "estilo-box";
              containerFilhoEmpresa.appendChild(divCNPJEmpresa);
              var PcnpjEmpresa = document.createElement("p");
              PcnpjEmpresa.innerHTML = "CNPJ";
              divCNPJEmpresa.appendChild(PcnpjEmpresa);
              divCNPJEmpresa.innerHTML += resposta[0].cnpj;


              //Logradouro da empresa


              var divLogradouro = document.createElement("div");
              divLogradouro.id = "logradouro_empresa_box";
              divLogradouro.className = "estilo-box";
              containerFilhoEmpresa.appendChild(divLogradouro);
              var Plogradouro = document.createElement("p");
              Plogradouro.innerHTML = "Logradouro";
              divLogradouro.appendChild(Plogradouro);
              divLogradouro.innerHTML += resposta[0].logradouro;


              //Cidade da empresa

              var divCidadeandUF = document.createElement("div");
              divCidadeandUF.className = "estilo-box-2";
              var divCidade = document.createElement("div");
              divCidadeandUF.appendChild(divCidade);
              containerFilhoEmpresa.appendChild(divCidadeandUF);
              divCidade.id = "cidade_empresa_box";
              divCidade.className = "cidade";
              var Pcidade = document.createElement("p");
              Pcidade.id = "cidade_empresa_cadastro";
              Pcidade.innerHTML = "Cidade";
              divCidade.appendChild(Pcidade);
              divCidade.innerHTML += resposta[0].cidade;



              //Estado da empresa

              var divEstado = document.createElement("div");
              divCidadeandUF.appendChild(divEstado);
              divEstado.id = "estado_empresa_box";
              divEstado.className = "estado";
              var Pestado = document.createElement("p");
              Pestado.id = "estado_empresa_cadastro";
              Pestado.innerHTML = "UF";
              divEstado.appendChild(Pestado);
              divEstado.innerHTML += resposta[0].estado
              


              //Cep da empresa

              var containerFilhoEmpresa2 = document.createElement("div");

              containerPai.appendChild(containerFilhoEmpresa2);
              containerFilhoEmpresa2.className = "container-filho-2";

              var divCep = document.createElement("div");
              divCep.id = "cep_empresa_box";
              divCep.className = "estilo-box";
              var Pcep = document.createElement("p");
              Pcep.id = "cep_empresa_cadastro";
              Pcep.innerHTML = "CEP";
              divCep.appendChild(Pcep);
              divCep.innerHTML += resposta[0].cep;
              containerFilhoEmpresa2.appendChild(divCep);


              //Bairro da empresa


              var divBairro = document.createElement("div");
              divBairro.id = "cnpj_empresa_box";
              divBairro.className = "estilo-box";
              var Pbairro = document.createElement("p");
              Pbairro.id = "bairro_empresa_cadastro";
              Pbairro.innerHTML = "Bairro";
              divBairro.appendChild(Pbairro);
              divBairro.innerHTML += resposta[0].bairro;
              containerFilhoEmpresa2.appendChild(divBairro);


              //Complemento da empresa

              var nomeComplemento = ""

              if(resposta[0].complemento == null) {
                nomeComplemento = ""
              } else {
                nomeComplemento = resposta[0].complemento
                var divComplemento = document.createElement("div");
              divComplemento.id = "complemento_empresa_box";
              divComplemento.className = "estilo-box";
              var Pcomplemento = document.createElement("p");
              Pcomplemento.id = "complemento_empresa_cadastro";
              Pcomplemento.innerHTML = "Complemento";
              divComplemento.appendChild(Pcomplemento);
              divComplemento.innerHTML += nomeComplemento;
              containerFilhoEmpresa2.appendChild(divComplemento);
              }



              document.getElementById(
                "container_filho_empresa"
              ).style.marginLeft = "17vw";
              document.getElementById("titulo_2_empresa").style.marginLeft =
                "12vw";

              });

}
})
.catch(function (resposta) {
console.log(`#ERRO: ${resposta}`);
});
}
}


  function cadastrarFuncionario() {
    var idEmpresa = sessionStorage.ID_EMPRESA
    //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo
    var userVar = inputUsuario.value;
    var senhaVar = btoa(inputSenha.value);
    var nomeVar = inputNome.value;
    var emailVar = inputEmail.value;
    var contatoVar = inputContato.value;
    var funcaoVar = inputFuncao.value;


    fetch(`/funcionario/cadastrarFuncionario/${idEmpresa}`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/funcionario.js
        idEmpresa: sessionStorage.ID_EMPRESA,
        userServer: userVar,
        senhaServer: senhaVar,
        nomeServer: nomeVar,
        emailServer: emailVar,
        contatoServer: contatoVar,
        funcaoServer: funcaoVar,
      }),
    })
      .then(function (resposta) {
        console.log("resposta: ", resposta, sessionStorage.ID_EMPRESA);

        if (resposta.ok) {
          Swal.fire({
          icon: 'success',
          title: 'Parabéns',
          text: 'Cadastro realizado com sucesso!',
          })

          setTimeout(() => {window.location.reload();}, 2000);
        } else {

          Swal.fire({
          icon: 'error',
          title: 'Ops...',
          text: 'Houve um erro ao tentar realizar o cadastro!',
          })
          console.log("respostaaaa: ", resposta, sessionStorage.ID_EMPRESA);
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
      });

    return false;
  }

  verificarFuncao()
verificarAdmin();
  function verificarAdmin() {
    if(sessionStorage.FUNCAO == "Administrador") {
      buscarDadosEmpresa();
    } else {
      buscardadosEmpresa2();
    }
  }
    // chama a função assim que a pagina carrega
</script>